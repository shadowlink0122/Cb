<section class="left-align">
  <h2>メモリ管理 - malloc/free/new/delete</h2>
  <div style="display: flex; gap: 1em; width: 95%; margin: 0.3em auto 0">
    <div style="flex: 1">
      <h3 style="font-size: 0.75em; margin-bottom: 0.2em">malloc/free - C言語スタイル</h3>
      <pre
        style="font-size: 0.45em; margin: 0.3em 0"
      ><code class="language-cpp" data-trim data-noescape><span style="color: #c586c0; font-weight: bold;">void</span> main() {
    <span style="color: #6a9955;">// メモリ確保</span>
    <span style="color: #4ec9b0;">int</span>* ptr = <span style="color: #c586c0; font-weight: bold;">malloc</span>(<span style="color: #c586c0; font-weight: bold;">sizeof</span>(<span style="color: #4ec9b0;">int</span>) * <span style="color: #b5cea8;">10</span>);
    
    <span style="color: #6a9955;">// 配列として使用</span>
    <span style="color: #c586c0; font-weight: bold;">for</span> (<span style="color: #4ec9b0;">int</span> i = <span style="color: #b5cea8;">0</span>; i &lt; <span style="color: #b5cea8;">10</span>; i++) {
        ptr[i] = i * <span style="color: #b5cea8;">2</span>;
    }
    
    <span style="color: #6a9955;">// メモリ解放</span>
    <span style="color: #c586c0; font-weight: bold;">free</span>(ptr);
}</code></pre>
      <h3 style="font-size: 0.75em; margin-bottom: 0.2em; margin-top: 0.4em">sizeof演算子</h3>
      <pre
        style="font-size: 0.45em; margin: 0.3em 0"
      ><code class="language-cpp" data-trim data-noescape><span style="color: #c586c0; font-weight: bold;">void</span> main() {
    println(<span style="color: #c586c0; font-weight: bold;">sizeof</span>(<span style="color: #4ec9b0;">int</span>));      <span style="color: #6a9955;">// 4</span>
    println(<span style="color: #c586c0; font-weight: bold;">sizeof</span>(<span style="color: #4ec9b0;">double</span>));   <span style="color: #6a9955;">// 8</span>
    println(<span style="color: #c586c0; font-weight: bold;">sizeof</span>(<span style="color: #4ec9b0;">char</span>));     <span style="color: #6a9955;">// 1</span>
}</code></pre>
    </div>
    <div style="flex: 1">
      <h3 style="font-size: 0.75em; margin-bottom: 0.2em">new/delete - C++スタイル</h3>
      <pre
        style="font-size: 0.45em; margin: 0.3em 0"
      ><code class="language-cpp" data-trim data-noescape><span style="color: #c586c0; font-weight: bold;">void</span> main() {
    <span style="color: #6a9955;">// 単一オブジェクト</span>
    <span style="color: #4ec9b0;">int</span>* p = <span style="color: #c586c0; font-weight: bold;">new</span> <span style="color: #4ec9b0;">int</span>;
    *p = <span style="color: #b5cea8;">42</span>;
    println(*p);
    <span style="color: #c586c0; font-weight: bold;">delete</span> p;
    
    <span style="color: #6a9955;">// 配列</span>
    <span style="color: #4ec9b0;">int</span>* arr = <span style="color: #c586c0; font-weight: bold;">new</span> <span style="color: #4ec9b0;">int</span>[<span style="color: #b5cea8;">5</span>];
    <span style="color: #c586c0; font-weight: bold;">for</span> (<span style="color: #4ec9b0;">int</span> i = <span style="color: #b5cea8;">0</span>; i &lt; <span style="color: #b5cea8;">5</span>; i++) {
        arr[i] = i + <span style="color: #b5cea8;">1</span>;
    }
    <span style="color: #c586c0; font-weight: bold;">delete</span>[] arr;
}</code></pre>
      <h3 style="font-size: 0.75em; margin-bottom: 0.2em; margin-top: 0.4em">構造体のメモリ管理</h3>
      <pre
        style="font-size: 0.45em; margin: 0.3em 0"
      ><code class="language-cpp" data-trim data-noescape><span style="color: #4ec9b0;">struct</span> <span style="color: #4ec9b0;">Point</span> {
    <span style="color: #4ec9b0;">int</span> x;
    <span style="color: #4ec9b0;">int</span> y;
}

<span style="color: #c586c0; font-weight: bold;">void</span> main() {
    <span style="color: #4ec9b0;">Point</span>* pt = <span style="color: #c586c0; font-weight: bold;">new</span> <span style="color: #4ec9b0;">Point</span>;
    pt-&gt;<span style="color: #9cdcfe;">x</span> = <span style="color: #b5cea8;">10</span>;
    pt-&gt;<span style="color: #9cdcfe;">y</span> = <span style="color: #b5cea8;">20</span>;
    <span style="color: #c586c0; font-weight: bold;">delete</span> pt;
}</code></pre>
    </div>
  </div>
</section>
