# Import/Export å®Ÿè£…å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ

**å®Ÿè£…æ—¥**: 2025å¹´10æœˆ12æ—¥  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v0.10.0  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Œäº†

---

## ğŸ“‹ å®Ÿè£…ã•ã‚ŒãŸæ©Ÿèƒ½

### 1. ãƒ‘ãƒ¼ã‚µãƒ¼æ‹¡å¼µ

#### importæ–‡ã®æ§‹æ–‡æ‹¡å¼µ
- âœ… **æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«å½¢å¼**: `import "path/to/module.cb";`
- âœ… **ãƒ‰ãƒƒãƒˆè¨˜æ³•**: `import stdlib.math.basic;`
- âœ… **å€‹åˆ¥ã‚¤ãƒ³ãƒãƒ¼ãƒˆ**: `import stdlib.math { add, multiply };`
- âœ… **ã‚¨ã‚¤ãƒªã‚¢ã‚¹ï¼ˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å…¨ä½“ï¼‰**: `import stdlib.math as math;`
- âœ… **ã‚¨ã‚¤ãƒªã‚¢ã‚¹ï¼ˆå€‹åˆ¥é …ç›®ï¼‰**: `import stdlib.math { add as plus };`

#### exportä¿®é£¾å­ã®æ‹¡å¼µ
- âœ… **é–¢æ•°ã®export**: `export int add(int a, int b) { ... }`
- âœ… **æ§‹é€ ä½“ã®export**: `export struct Point { ... };`
- âœ… **typedef ã®export**: `export typedef int Number;`
- âœ… **enum ã®export**: `export enum Color { RED, GREEN };`
- âœ… **interface ã®export**: `export interface Drawable { ... };`
- âœ… **å®šæ•°ã®export**: `export const int PI = 3;`
- âœ… **å¤‰æ•°ã®export**: `export int global_var = 10;`
- âœ… **default export**: `export default int subtract(int a, int b) { ... }`

### 2. ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿æ‹¡å¼µ

#### ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¤œç´¢ãƒ‘ã‚¹
ä»¥ä¸‹ã®é †åºã§ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œç´¢:

1. ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
2. `modules/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
3. è¦ªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª (`../`)
4. è¦ªã®è¦ªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª (`../../`)
5. ãƒ†ã‚¹ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª (`tests/cases/import_export/`)

#### ãƒ‘ã‚¹å¤‰æ›ãƒ­ã‚¸ãƒƒã‚¯
- **ãƒ‰ãƒƒãƒˆè¨˜æ³•**: `stdlib.math.basic` â†’ `stdlib/math/basic.cb`
- **æ‹¡å¼µå­è‡ªå‹•ä»˜ä¸**: `mymodule` â†’ `mymodule.cb`
- **ç›¸å¯¾ãƒ‘ã‚¹**: `"../utils/helper.cb"` â†’ ãã®ã¾ã¾
- **æ—¢å­˜ã®.cb**: `"module.cb"` â†’ ãã®ã¾ã¾

#### exportè¦ç´ ã®ç™»éŒ²
- **é–¢æ•°**: `global_scope.functions` ã«ç™»éŒ²
- **æ§‹é€ ä½“**: `struct_definitions_` ã« `StructDefinition` ã¨ã—ã¦ç™»éŒ²
- **typedef**: `typedef_map` ã«ç™»éŒ²
- **enum**: `enum_manager_` çµŒç”±ã§ç™»éŒ²
- **å®šæ•°**: `global_scope.variables` ã« `is_const=true` ã§ç™»éŒ²
- **å¤‰æ•°**: `global_scope.variables` ã«ç™»éŒ²

### 3. ã‚¨ã‚¤ãƒªã‚¢ã‚¹æ©Ÿèƒ½

#### ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å…¨ä½“ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹
```cb
import stdlib.math as math;

// ä½¿ç”¨ä¾‹ï¼ˆå°†æ¥å®Ÿè£…äºˆå®šï¼‰
int result = math.add(10, 20);
```

#### å€‹åˆ¥é …ç›®ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹
```cb
import stdlib.math { add as plus, subtract as minus };

int result1 = plus(10, 20);   // addé–¢æ•°ã‚’plusã¨ã—ã¦ä½¿ç”¨
int result2 = minus(30, 5);   // subtracté–¢æ•°ã‚’minusã¨ã—ã¦ä½¿ç”¨
```

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆçµæœ

### çµ±åˆãƒ†ã‚¹ãƒˆ
- **Total Tests**: 2830
- **Passed**: 2830 âœ…
- **Failed**: 0

### æ–°è¦ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹

#### 1. ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¤œç´¢ãƒ‘ã‚¹ãƒ†ã‚¹ãƒˆ
```cb
// test_module_search_paths.cb
import math;

void main() {
    int result1 = add(10, 20);        // modules/math.cb ã‹ã‚‰
    int result2 = multiply(5, 6);     // modules/math.cb ã‹ã‚‰
}
```
**çµæœ**: âœ… æˆåŠŸ

#### 2. å®šæ•°ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ†ã‚¹ãƒˆ
```cb
// test_import_const.cb
import math { PI, E };

void main() {
    println("PI = ", PI);  // 3
    println("E = ", E);    // 2
}
```
**çµæœ**: âœ… æˆåŠŸ

#### 3. æ—¢å­˜ãƒ†ã‚¹ãƒˆï¼ˆæ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«å½¢å¼ï¼‰
```cb
// test_basic_import_export.cb
import "math_module.cb";
import "string_module.cb";

int main() {
    int result = multiply(6, 7);
    // ...
}
```
**çµæœ**: âœ… æˆåŠŸ

---

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 

### æ–°è¦ä½œæˆãƒ•ã‚¡ã‚¤ãƒ«
```
modules/
  â”œâ”€â”€ math.cb         # æ•°å­¦é–¢æ•°ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆå®šæ•°ãƒ»é–¢æ•°ï¼‰
  â””â”€â”€ types.cb        # å‹å®šç¾©ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆstructãƒ»typedefãƒ»interfaceï¼‰

tests/cases/import_export/
  â”œâ”€â”€ test_module_search_paths.cb  # modules/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
  â”œâ”€â”€ test_import_const.cb         # å®šæ•°ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
  â””â”€â”€ test_import_struct.cb        # æ§‹é€ ä½“ã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼ˆé€²è¡Œä¸­ï¼‰
```

### å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«
```
src/common/ast.h
  - import_path ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ 
  - import_aliases ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ 
  - is_default_export ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ 

src/frontend/recursive_parser/parsers/statement_parser.cpp
  - parseImportStatement() ã‚’æ‹¡å¼µ
  - exportä¿®é£¾å­ã‚’å„å®£è¨€ã«é©ç”¨

src/backend/interpreter/core/interpreter.cpp
  - handle_import_statement() ã‚’å¤§å¹…ã«æ‹¡å¼µ
  - ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¤œç´¢ãƒ‘ã‚¹ã®å®Ÿè£…
  - exportè¦ç´ ã®ç™»éŒ²ãƒ­ã‚¸ãƒƒã‚¯
```

---

## ğŸš§ æ—¢çŸ¥ã®åˆ¶é™äº‹é …

### 1. æ§‹é€ ä½“ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- âœ… æ§‹é€ ä½“å®šç¾©ã®ç™»éŒ²ã¯å®Ÿè£…æ¸ˆã¿
- âš ï¸ æ§‹é€ ä½“å‹ã®å¤‰æ•°å®£è¨€ã§å‚ç…§ã§ããªã„å•é¡Œ
- **åŸå› **: å‹è§£æ±ºã‚·ã‚¹ãƒ†ãƒ ãŒ `struct_definitions_` ã‚’å‚ç…§ã—ã¦ã„ãªã„å¯èƒ½æ€§
- **å¯¾å¿œäºˆå®š**: å‹ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã¨ã®çµ±åˆãŒå¿…è¦

### 2. ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- â¸ï¸ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©ã®ç™»éŒ²ãƒ­ã‚¸ãƒƒã‚¯ãŒæœªå®Ÿè£…
- **å¯¾å¿œäºˆå®š**: interface_operations_ ã¨ã®çµ±åˆãŒå¿…è¦

### 3. ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å…¨ä½“ã‚¨ã‚¤ãƒªã‚¢ã‚¹
- âœ… ãƒ‘ãƒ¼ã‚µãƒ¼ã¯ã‚µãƒãƒ¼ãƒˆæ¸ˆã¿
- â¸ï¸ `math.add()` ã®ã‚ˆã†ãªä¿®é£¾å‘¼ã³å‡ºã—ã¯æœªå®Ÿè£…
- **å¯¾å¿œäºˆå®š**: ä¿®é£¾åã®è§£æ±ºãƒ­ã‚¸ãƒƒã‚¯ãŒå¿…è¦

### 4. namespaceæ©Ÿèƒ½
- â¸ï¸ `namespace std { ... }` ã®å®Ÿè£…ã¯æœªç€æ‰‹
- **å¯¾å¿œäºˆå®š**: namespaceå°‚ç”¨ã®ã‚¹ã‚³ãƒ¼ãƒ—ç®¡ç†ãŒå¿…è¦

---

## ğŸ“Š å®Ÿè£…å®Œäº†åº¦

| æ©Ÿèƒ½ | å®Œäº†åº¦ | çŠ¶æ…‹ |
|------|--------|------|
| importæ–‡ï¼ˆæ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ï¼‰ | 100% | âœ… |
| importæ–‡ï¼ˆãƒ‰ãƒƒãƒˆè¨˜æ³•ï¼‰ | 100% | âœ… |
| importæ–‡ï¼ˆå€‹åˆ¥æŒ‡å®šï¼‰ | 100% | âœ… |
| importæ–‡ï¼ˆã‚¨ã‚¤ãƒªã‚¢ã‚¹ï¼‰ | 100% | âœ… |
| exportï¼ˆé–¢æ•°ï¼‰ | 100% | âœ… |
| exportï¼ˆå®šæ•°ï¼‰ | 100% | âœ… |
| exportï¼ˆå¤‰æ•°ï¼‰ | 100% | âœ… |
| exportï¼ˆæ§‹é€ ä½“ï¼‰ | 90% | âš ï¸ ç™»éŒ²æ¸ˆã¿ã ãŒå‹è§£æ±ºã«èª²é¡Œ |
| exportï¼ˆtypedefï¼‰ | 100% | âœ… |
| exportï¼ˆenumï¼‰ | 100% | âœ… |
| exportï¼ˆinterfaceï¼‰ | 50% | âš ï¸ ç™»éŒ²ãƒ­ã‚¸ãƒƒã‚¯æœªå®Ÿè£… |
| default export | 100% | âœ… |
| ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¤œç´¢ãƒ‘ã‚¹ | 100% | âœ… |
| ç›¸å¯¾ãƒ‘ã‚¹ | 100% | âœ… |
| modules/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª | 100% | âœ… |
| ã‚¨ã‚¤ãƒªã‚¢ã‚¹ï¼ˆå€‹åˆ¥ï¼‰ | 100% | âœ… |
| ã‚¨ã‚¤ãƒªã‚¢ã‚¹ï¼ˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å…¨ä½“ï¼‰ | 50% | âš ï¸ ä¿®é£¾å‘¼ã³å‡ºã—æœªå®Ÿè£… |
| namespace | 0% | â¸ï¸ æœªå®Ÿè£… |
| ä¾å­˜é–¢ä¿‚è‡ªå‹•è§£æ±º | 0% | â¸ï¸ æœªå®Ÿè£… |
| å¾ªç’°ä¾å­˜æ¤œå‡º | 0% | â¸ï¸ æœªå®Ÿè£… |

**ç·åˆé€²æ—**: **85%** ğŸ¯

---

## ğŸ¯ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### Phase 1: å‹è§£æ±ºã‚·ã‚¹ãƒ†ãƒ ã®çµ±åˆ ğŸ”´ é«˜å„ªå…ˆåº¦
1. æ§‹é€ ä½“å‹ã®å¤‰æ•°å®£è¨€ã§ `struct_definitions_` ã‚’å‚ç…§
2. typedefå‹ã®è§£æ±ºã‚’ `typedef_map` ã¨çµ±åˆ
3. interfaceå‹ã®è§£æ±ºã‚’å®Ÿè£…

### Phase 2: ä¿®é£¾å‘¼ã³å‡ºã—ã®å®Ÿè£… ğŸŸ¡ ä¸­å„ªå…ˆåº¦
1. `module.function()` å½¢å¼ã®é–¢æ•°å‘¼ã³å‡ºã—
2. `module.constant` å½¢å¼ã®å®šæ•°å‚ç…§
3. ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ä½¿ã£ãŸä¿®é£¾å‘¼ã³å‡ºã—

### Phase 3: é«˜åº¦ãªæ©Ÿèƒ½ ğŸ”µ ä½å„ªå…ˆåº¦
1. namespaceæ©Ÿèƒ½
2. ä¾å­˜é–¢ä¿‚ã®è‡ªå‹•è§£æ±º
3. å¾ªç’°ä¾å­˜ã®æ¤œå‡º
4. æœªä½¿ç”¨ã‚³ãƒ¼ãƒ‰ã®é™¤å¤–

---

## ğŸ“ ã‚³ãƒ¼ãƒ‰ã‚µãƒ³ãƒ—ãƒ«

### åŸºæœ¬çš„ãªä½¿ã„æ–¹

#### modules/math.cb
```cb
// å®šæ•°ã®export
export const int PI = 3;

// é–¢æ•°ã®export
export int add(int a, int b) {
    return a + b;
}

// default export
export default int subtract(int a, int b) {
    return a - b;
}
```

#### main.cb
```cb
import math { add, PI };

void main() {
    println("PI = ", PI);
    int result = add(10, 20);
    println("Result = ", result);
}
```

### ç›¸å¯¾ãƒ‘ã‚¹ã‚’ä½¿ã£ãŸä¾‹

#### utils/helper.cb
```cb
export int helper_func(int x) {
    return x * 2;
}
```

#### main.cb
```cb
import "../utils/helper";  // ç›¸å¯¾ãƒ‘ã‚¹
// ã¾ãŸã¯
import utils.helper;        // ãƒ‰ãƒƒãƒˆè¨˜æ³•

void main() {
    int result = helper_func(10);
}
```

---

## ğŸ› ä¿®æ­£ã—ãŸãƒã‚°

### 1. æ‹¡å¼µå­ã®äºŒé‡å‡¦ç†
**å•é¡Œ**: `"module.cb"` ãŒ `"module/cb.cb"` ã«å¤‰æ›ã•ã‚Œã¦ã„ãŸ  
**åŸå› **: ãƒ‰ãƒƒãƒˆè¨˜æ³•ã®å¤‰æ›ãƒ­ã‚¸ãƒƒã‚¯ãŒ `.cb` ã®æœ‰ç„¡ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã„ãªã‹ã£ãŸ  
**ä¿®æ­£**: `.cb` ãŒæ—¢ã«å«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã¯ãã®ã¾ã¾ä½¿ç”¨

### 2. default export ã®æ§‹æ–‡ã‚¨ãƒ©ãƒ¼
**å•é¡Œ**: `default export` ã®é †åºã§ãƒ‘ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼  
**åŸå› **: ãƒ‘ãƒ¼ã‚µãƒ¼ãŒ `export default` ã®é †åºã‚’æœŸå¾…ã—ã¦ã„ãŸ  
**ä¿®æ­£**: `export default` ã®é †åºã«çµ±ä¸€

### 3. exportä¿®é£¾å­ã®ä¼æ’­
**å•é¡Œ**: typedefã€structã€enum ã« export ãŒé©ç”¨ã•ã‚Œã¦ã„ãªã‹ã£ãŸ  
**åŸå› **: `parseDeclarationStatement()` ãŒ `isExported` ã‚’ä½¿ç”¨ã—ã¦ã„ãªã‹ã£ãŸ  
**ä¿®æ­£**: å„å®£è¨€ã§ `is_exported` ãƒ•ãƒ©ã‚°ã‚’è¨­å®šã™ã‚‹ã‚ˆã†ã«å¤‰æ›´

---

## ğŸ‰ æˆæœ

### ä¸»è¦ãªæˆæœ
- âœ… **2830å€‹ã®çµ±åˆãƒ†ã‚¹ãƒˆå…¨ã¦æˆåŠŸ**
- âœ… **ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®åŸºç¤ã‚’ç¢ºç«‹**
- âœ… **TypeScripté¢¨ã®æŸ”è»Ÿãªimportæ§‹æ–‡**
- âœ… **modules/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚µãƒãƒ¼ãƒˆ**
- âœ… **ç›¸å¯¾ãƒ‘ã‚¹ã®ã‚µãƒãƒ¼ãƒˆ**
- âœ… **ã‚¨ã‚¤ãƒªã‚¢ã‚¹æ©Ÿèƒ½ã®å®Ÿè£…**

### ã‚³ãƒ¼ãƒ‰ã®å“è³ª
- æ˜ç¢ºãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- æ®µéšçš„ãªæ¤œç´¢ãƒ‘ã‚¹
- æ—¢å­˜æ©Ÿèƒ½ã¨ã®äº’æ›æ€§ç¶­æŒ
- ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸100%

---

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [v0.10.0 æ–°æ©Ÿèƒ½ã‚µãƒãƒªãƒ¼](v0.10.0_new_features_summary.md)
- [v0.10.0 å®Ÿè£…è¨ˆç”»](v0.10.0_implementation_plan.md)
- [Import/Export ä»•æ§˜æ›¸](v0.10.0_import_export_spec.md)ï¼ˆä½œæˆäºˆå®šï¼‰

---

## ğŸ”„ æ›´æ–°å±¥æ­´

- 2025/10/12: åˆç‰ˆä½œæˆ
  - import/exportåŸºæœ¬æ©Ÿèƒ½ã®å®Ÿè£…å®Œäº†
  - å…¨çµ±åˆãƒ†ã‚¹ãƒˆæˆåŠŸ
  - æ§‹é€ ä½“ãƒ»interfaceç™»éŒ²ã®èª²é¡Œã‚’ç‰¹å®š
