# バージョン戦略大幅変更ドキュメント（第2版）

**作成日**: 2025年11月14日  
**ステータス**: ✅ 完了（第2版）

---

## 🎯 変更の背景

第1版の再編成後、さらに重要な方針転換が必要と判断されました。

### 第1版の問題点

1. **v0.14.0の内容が曖昧**: Generic配列（基本機能）とIR実装（コンパイラ）が混在
2. **基本機能実装の完結が不明確**: いつ基本機能が完成するか不透明
3. **コンパイラ実装への移行が段階的**: 明確な区切りがない

### 解決策（第2版）

**基本機能実装とコンパイラ実装を完全に分離**

- **v0.13.x（パッチ）**: 基本機能の完成に専念
- **v0.14.0以降（マイナー）**: コンパイラ実装に専念

---

## 📋 変更内容

### Before（第1版）

```
v0.13.0: Released
v0.13.1: テストカバレッジ、バグ修正（パッチ）
v0.14.0: Generic配列 + IR基盤実装（マイナー）← 混在
v0.15.0: 複数バックエンド対応
v0.16.0: 標準ライブラリ完全化
v0.17.0: パッケージエコシステム
```

### After（第2版）

```
v0.13.0: Released
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
基本機能完成フェーズ（v0.13.x パッチ）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
v0.13.1: テストカバレッジ、Asyncバグ修正
v0.13.2: Generic配列サポート         ← 新規追加
v0.13.3: 追加機能、完成度向上          ← 新規追加
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
コンパイラ実装フェーズ（v0.14.0~ マイナー）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
v0.14.0: IR基盤実装（HIR/MIR/LIR）    ← 前倒し
v0.15.0: 複数バックエンド対応           ← 前倒し
v0.16.0: 標準ライブラリ完全化           ← 前倒し
```

---

## 🔄 具体的な変更

### 1. ディレクトリ構造の変更

```bash
# 新規作成
docs/todo/v0.13.2/  # Generic配列サポート（旧v0.14.0から移動）
docs/todo/v0.13.3/  # 追加機能・完成度向上

# 再編成
docs/todo/v0.14.0/  # IR基盤実装（旧v0.15.0から内容移動）
docs/todo/v0.15.0/  # 複数バックエンド（旧v0.16.0から移動）
docs/todo/v0.16.0/  # 標準ライブラリ（旧v0.17.0から移動）

# 削除
docs/todo/v0.17.0/  # パッケージエコシステムはv1.0.0へ延期
```

### 2. ファイルのリネームと移動

**v0.13.2/**（新規作成）:
- 旧v0.14.0の内容を移動
- `v0.14.0_*.md` → `v0.13.2_*.md`
- Generic配列サポートに特化

**v0.13.3/**（新規作成）:
- 追加機能・完成度向上
- 柔軟な内容（必要に応じて追加）

**v0.14.0/**:
- 旧v0.15.0のIR実装内容を移動
- コンパイラ実装の開始点

**v0.15.0/** → **v0.14.0**:
- 複数バックエンド対応を1つ前倒し

**v0.16.0/** → **v0.15.0**:
- 標準ライブラリ完全化を1つ前倒し

**v0.17.0/** → **v0.16.0**:
- パッケージエコシステムを1つ前倒し

### 3. ドキュメントの作成・更新

**新規作成**:
- `v0.13.2/v0.13.2_implementation_plan.md`
- `v0.13.3/README.md`
- `v0.14.0/v0.14.0_implementation_plan.md`
- `ROADMAP_v0.13.x-v0.16.0_LATEST.md`
- `VERSION_STRATEGY_V2.md`（このファイル）

**更新**:
- `docs/todo/README.md` - 全面改訂（第2版対応）

---

## 📊 新しいバージョン体系

### フェーズ分け

#### Phase 1: 基本機能完成（v0.13.x）

**期間**: 4-7ヶ月  
**種別**: パッチバージョン  
**アプローチ**: インタプリタベース

| バージョン | 期間 | 内容 |
|-----------|------|------|
| v0.13.1 | 2-3ヶ月 | テストカバレッジ、Asyncバグ修正 |
| v0.13.2 | 1-2ヶ月 | Generic配列サポート |
| v0.13.3 | 1-2ヶ月 | 追加機能、完成度向上 |

**ゴール**: すべての基本言語機能の実装完了

#### Phase 2: コンパイラ実装（v0.14.0~）

**期間**: 11-14ヶ月  
**種別**: マイナーバージョン  
**アプローチ**: コンパイラベース

| バージョン | 期間 | 内容 |
|-----------|------|------|
| v0.14.0 | 3-4ヶ月 | IR基盤実装（HIR/MIR/LIR） |
| v0.15.0 | 3-4ヶ月 | 複数バックエンド対応 |
| v0.16.0 | 2-3ヶ月 | 標準ライブラリ完全化 |

**ゴール**: 高性能な本格的コンパイラの完成

---

## 🎯 方針の明確化

### v0.13.x（パッチバージョン）の役割

**目的**: 基本機能の完成

**内容**:
- インタプリタベースの実装
- 言語機能の追加・改善
- バグ修正、テスト追加
- ドキュメント整備

**制約**:
- アーキテクチャ変更なし
- インタプリタの範囲内で実装
- 既存コードへの影響最小化

### v0.14.0~（マイナーバージョン）の役割

**目的**: コンパイラ実装

**内容**:
- IR（中間表現）の実装
- 複数バックエンド対応
- 最適化パスの実装
- ネイティブコード生成

**特徴**:
- アーキテクチャの大幅変更
- 新しいインフラストラクチャ
- パフォーマンスの大幅向上

---

## ✨ 第2版の利点

### 1. 明確な区切り

✅ **v0.13.x完了 = 基本機能完成**  
✅ **v0.14.0開始 = コンパイラ実装開始**

### 2. セマンティックバージョニングの正しい適用

✅ **パッチ（v0.13.x）**: 既存インフラ内での改善  
✅ **マイナー（v0.14.0~）**: アーキテクチャ変更

### 3. 開発の焦点化

✅ **v0.13.x**: 言語機能に専念  
✅ **v0.14.0~**: コンパイラに専念

### 4. ユーザーにとって明確

✅ **v0.13.x**: 安定した機能追加  
✅ **v0.14.0~**: パフォーマンス向上

---

## 📈 期待される効果

### 開発効率

- **明確な目標**: 各バージョンの目的が明確
- **集中できる**: 混在せず、1つのことに集中
- **計画が立てやすい**: 各フェーズの期間が明確

### コードベースの品質

- **基本機能の安定化**: v0.13.xで徹底的に安定化
- **コンパイラの品質**: v0.14.0~でコンパイラに専念

### ユーザー体験

- **v0.13.x**: 機能が増え、使いやすくなる
- **v0.14.0~**: 速度が大幅に向上

---

## 📝 今後のアクション

### 即座に実施（完了）

- [x] ディレクトリ構造の再編成
- [x] ファイルのリネーム
- [x] 実装計画ドキュメントの作成
- [x] ROADMAPの全面改訂
- [x] README.mdの更新

### v0.13.1開発開始時

- [ ] `docs/todo/v0.13.1/` のタスクを実行
- [ ] テストカバレッジ67% → 100%
- [ ] Async機能のバグ修正
- [ ] ドキュメント整備

### v0.13.2以降

- [ ] Generic配列サポート実装
- [ ] 追加機能の実装（必要に応じて）
- [ ] 基本機能の完全な完成

### v0.14.0以降

- [ ] IR基盤実装
- [ ] 複数バックエンド対応
- [ ] 標準ライブラリ完全化

---

## 🔍 比較：第1版 vs 第2版

| 項目 | 第1版 | 第2版 |
|------|-------|-------|
| **v0.13.1** | テストカバレッジ | テストカバレッジ |
| **v0.13.2** | （なし） | Generic配列 🆕 |
| **v0.13.3** | （なし） | 追加機能・完成度向上 🆕 |
| **v0.14.0** | Generic配列 + IR | IR基盤実装のみ |
| **v0.15.0** | 複数バックエンド | 複数バックエンド |
| **v0.16.0** | 標準ライブラリ | 標準ライブラリ |
| **v0.17.0** | パッケージ | （削除、v1.0.0へ） |
| **基本機能完成** | 不明確 | v0.13.3で明確に完了 ✅ |
| **コンパイラ開始** | v0.14.0から段階的 | v0.14.0で完全移行 ✅ |

---

## 🎉 結論

第2版の再編成により、以下が達成されました：

1. ✅ **明確なフェーズ分け**: 基本機能 vs コンパイラ実装
2. ✅ **セマンティックバージョニングの正しい適用**: パッチ vs マイナー
3. ✅ **開発の焦点化**: 各バージョンで1つのことに集中
4. ✅ **ユーザーにとって明確**: 何が変わるか一目瞭然

Cb言語の開発計画が、より合理的で実行可能なものになりました。

---

**作成者**: Cb言語開発チーム  
**承認日**: 2025年11月14日（第2版）
