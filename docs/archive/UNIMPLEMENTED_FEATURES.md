# Cb言語 未実装機能一覧

最終更新: 2024年（const関数引数実装後）

このドキュメントは、Cb言語で現在未実装または部分実装の機能を網羅的に列挙します。

---

## 📊 実装状況サマリー

- ✅ **完全実装済み**: 2206個のテストが全て成功
- 🚧 **部分実装**: 基本機能は動作するが制限あり
- ❌ **未実装**: まだ実装されていない機能

---

## 🔴 1. 構造体システムの制限

### 1.1 ネストした構造体（値メンバー）❌

**状態**: 完全未実装

**説明**: 
構造体のメンバーとして別の構造体を値で持つことができません。

**エラーになるコード**:
```cb
struct Address {
    string city;
    int zip;
}

struct Person {
    string name;
    Address address;  // ❌ エラー: ネストした構造体未サポート
}

int main() {
    Person p;
    p.address.city = "Tokyo";  // ❌ エラー
    return 0;
}
```

**回避策**: 
ポインタを使用する（ポインタシステムが完全実装された場合）:
```cb
struct Person {
    string name;
    Address* address;  // ✅ ポインタ経由なら可能
}
```

**実装難易度**: 🔴 高（メモリレイアウト、初期化順序、コピーセマンティクス）

---

### 1.2 自己再帰構造体（値メンバー）⚠️

**状態**: ポインタ経由でのみ可能

**説明**: 
実際には自己再帰構造体は**ポインタ経由なら動作します**（検証済み）。
値メンバーとして自己参照することはできません（これは理論的に不可能）。

**動作するコード**:
```cb
struct Node {
    int value;
    Node* next;  // ✅ ポインタなら動作
}

int main() {
    Node n1;
    n1.value = 1;
    n1.next = 0;
    
    Node n2;
    n2.value = 2;
    n2.next = &n1;  // ✅ 正常動作
    
    return 0;
}
```

**エラーになるコード**:
```cb
struct Node {
    int value;
    Node child;  // ❌ 値メンバーとしての自己参照は不可能
}
```

**結論**: これは制限ではなく、ポインタシステムが正しく実装されていることの証明です。

---

### 1.3 構造体継承 ❌

**状態**: 完全未実装

**説明**: 
C++やJavaのようなクラス継承システムはありません。

**エラーになるコード**:
```cb
struct Animal {
    string name;
}

struct Dog : Animal {  // ❌ 継承構文は未サポート
    string breed;
}
```

**回避策**: 
Interface/Implシステムを使用:
```cb
interface Animal {
    string get_name();
}

struct Dog {
    string name;
    string breed;
}

impl Animal for Dog {
    string get_name() {
        return self.name;
    }
}
```

**実装難易度**: 🔴 高（設計上、interfaceシステムで代替可能なため優先度低）

---

### 1.4 構造体内メソッド定義 ❌

**状態**: 部分実装（implシステムで代替可能）

**説明**: 
構造体定義内にメソッドを直接定義できません。

**エラーになるコード**:
```cb
struct Point {
    int x;
    int y;
    
    // ❌ エラー: 構造体内メソッド定義未サポート
    int distance() {
        return x * x + y * y;
    }
}
```

**回避策**: 
Implシステムを使用:
```cb
struct Point {
    int x;
    int y;
}

impl Point {
    int distance() {
        return self.x * self.x + self.y * self.y;
    }
}
```

**実装難易度**: 🟡 中（implシステムで代替可能）

---

## 🔴 2. ポインタシステムの制限

### 2.1 ポインタ演算 ❌

**状態**: 完全未実装

**説明**: 
ポインタのインクリメント、デクリメント、加算、減算が未実装。

**エラーになるコード**:
```cb
int main() {
    int[5] arr = [1, 2, 3, 4, 5];
    int* ptr = &arr[0];
    
    ptr++;           // ❌ 未実装
    ptr += 2;        // ❌ 未実装
    ptr--;           // ❌ 未実装
    
    int* ptr2 = &arr[3];
    int diff = ptr2 - ptr;  // ❌ ポインタ間の距離計算未実装
    
    return 0;
}
```

**実装難易度**: 🟡 中

---

### 2.2 ポインタへの複合代入 ❌

**状態**: 完全未実装

**説明**: 
デリファレンスしたポインタへの複合代入演算子が動作しません。

**エラーになるコード**:
```cb
int main() {
    int value = 10;
    int* ptr = &value;
    
    *ptr += 5;   // ❌ 未実装
    *ptr *= 2;   // ❌ 未実装
    
    return 0;
}
```

**回避策**:
```cb
*ptr = *ptr + 5;  // ✅ 明示的な代入は動作
```

**実装難易度**: 🟢 低

---

### 2.3 関数ポインタ ❌

**状態**: 完全未実装

**説明**: 
関数へのポインタを変数として持つことができません。

**エラーになるコード**:
```cb
int add(int a, int b) {
    return a + b;
}

int main() {
    int (*func_ptr)(int, int) = &add;  // ❌ 未実装
    int result = func_ptr(3, 4);       // ❌ 未実装
    return 0;
}
```

**実装難易度**: 🔴 高

---

### 2.4 Interfaceポインタのメソッド呼び出し ⚠️

**状態**: 部分実装

**説明**: 
Interfaceポインタ経由でのメソッド呼び出しが動作しない場合があります。

**問題のあるコード**:
```cb
interface Drawable {
    void draw();
}

struct Circle {
    int radius;
}

impl Drawable for Circle {
    void draw() {
        println("Drawing circle");
    }
}

int main() {
    Circle c;
    c.radius = 5;
    
    Drawable* d = &c;  // ポインタは作成できる
    d->draw();         // ⚠️ メソッド呼び出しが不安定
    
    return 0;
}
```

**実装難易度**: 🟡 中

---

### 2.5 const correctness ⚠️

**状態**: 部分実装（関数引数のconstは実装済み）

**説明**: 
constポインタ、ポインタへのconst等の完全な型安全性はまだ完全ではありません。

**現在の状態**:
- ✅ const関数引数: 実装済み
- ❌ constポインタ: 未実装
- ❌ ポインタtoConst: 未実装

**エラーになるコード**:
```cb
int main() {
    const int value = 10;
    const int* ptr = &value;  // ❌ constポインタ未実装
    
    int x = 5;
    int* const ptr2 = &x;     // ❌ ポインタconst未実装
    
    return 0;
}
```

**実装難易度**: 🟡 中

---

## 🔴 3. メモリ管理

### 3.1 動的メモリ確保（new/delete）❌

**状態**: 完全未実装

**説明**: 
C++の`new`/`delete`やC言語の`malloc`/`free`相当の機能がありません。

**エラーになるコード**:
```cb
int main() {
    int* ptr = new int;        // ❌ 未実装
    *ptr = 42;
    delete ptr;                // ❌ 未実装
    
    int* arr = new int[10];    // ❌ 配列版も未実装
    delete[] arr;              // ❌ 未実装
    
    return 0;
}
```

**実装難易度**: 🔴 高

---

### 3.2 スマートポインタ ❌

**状態**: 完全未実装

**説明**: 
C++11以降のスマートポインタ（`unique_ptr`, `shared_ptr`, `weak_ptr`）相当の機能がありません。

**未実装の機能**:
```cb
// 全て未実装
unique_ptr<int> ptr1 = make_unique<int>(42);
shared_ptr<int> ptr2 = make_shared<int>(100);
weak_ptr<int> ptr3 = ptr2;
```

**実装難易度**: 🔴 高（RAII、所有権管理、参照カウント）

---

### 3.3 ガベージコレクション ❌

**状態**: 完全未実装（設計上、実装しない方針）

**説明**: 
自動メモリ管理機構はありません。RAIIとスマートポインタで代替予定。

**実装難易度**: 🔴 高（設計上、実装しない）

---

## 🔴 4. 型システムの制限

### 4.1 動的配列 ❌

**状態**: 完全未実装

**説明**: 
可変長配列（Vector、スライス等）がありません。

**エラーになるコード**:
```cb
int main() {
    int[] arr;            // ❌ サイズ未指定配列は未サポート
    arr.push(10);         // ❌ 動的追加メソッド未実装
    arr.resize(20);       // ❌ リサイズ未実装
    
    return 0;
}
```

**回避策**: 
固定サイズ配列を使用:
```cb
int[100] arr;  // ✅ 固定サイズなら動作
```

**実装難易度**: 🟡 中

---

### 4.2 ジェネリクス（型パラメータ）❌

**状態**: 完全未実装

**説明**: 
C++のテンプレート、Rustのジェネリクス相当の機能がありません。

**エラーになるコード**:
```cb
// ❌ ジェネリック関数未実装
fn max<T>(a: T, b: T) -> T {
    return a > b ? a : b;
}

// ❌ ジェネリック構造体未実装
struct Box<T> {
    T value;
}
```

**実装難易度**: 🔴 高

---

### 4.3 Union型の浮動小数点数対応 ⚠️

**状態**: 部分未実装

**説明**: 
Union型でfloat/doubleが完全にサポートされていない場合があります。

**問題のあるコード**:
```cb
typedef NumericValue = int | float | double;  // ⚠️ 動作不安定

int main() {
    NumericValue val = 3.14;  // ⚠️ float/doubleの扱いに制限
    return 0;
}
```

**実装難易度**: 🟡 中

---

### 4.4 型推論（auto）❌

**状態**: 完全未実装

**説明**: 
C++11の`auto`、Rustの型推論相当の機能がありません。

**エラーになるコード**:
```cb
int main() {
    auto x = 10;           // ❌ auto未実装
    auto result = add(3, 5); // ❌ 未実装
    
    return 0;
}
```

**実装難易度**: 🟡 中

---

## 🔴 5. 制御構造の制限

### 5.1 switch/case文 ❌

**状態**: 完全未実装

**説明**: 
C言語の`switch`/`case`文がありません。

**エラーになるコード**:
```cb
int main() {
    int x = 5;
    
    switch (x) {        // ❌ switch未実装
        case 1:
            println("one");
            break;
        case 5:
            println("five");
            break;
        default:
            println("other");
    }
    
    return 0;
}
```

**回避策**:
```cb
// if-else chainで代替
if (x == 1) {
    println("one");
} else if (x == 5) {
    println("five");
} else {
    println("other");
}
```

**実装難易度**: 🟢 低

---

### 5.2 例外処理（try/catch/throw）❌

**状態**: 完全未実装（設計上、Result型で代替予定）

**説明**: 
C++/Java/Pythonの例外処理機構はありません。

**エラーになるコード**:
```cb
int main() {
    try {                        // ❌ try未実装
        throw "Error occurred";  // ❌ throw未実装
    } catch (string e) {         // ❌ catch未実装
        println("Error: ", e);
    }
    
    return 0;
}
```

**代替予定**: 
Rust風のResult型（将来実装予定）:
```cb
// 将来実装予定
Result<int, string> divide(int a, int b) {
    if (b == 0) {
        return Err("Division by zero");
    }
    return Ok(a / b);
}
```

**実装難易度**: 🔴 高

---

### 5.3 パターンマッチング ❌

**状態**: 完全未実装

**説明**: 
Rustの`match`、関数型言語のパターンマッチングがありません。

**エラーになるコード**:
```cb
int main() {
    int x = 5;
    
    match (x) {           // ❌ match未実装
        1 => println("one"),
        2 | 3 => println("two or three"),
        _ => println("other")
    }
    
    return 0;
}
```

**実装難易度**: 🔴 高

---

## 🔴 6. 関数システムの制限

### 6.1 ラムダ式/クロージャ ❌

**状態**: 完全未実装

**説明**: 
無名関数、クロージャがありません。

**エラーになるコード**:
```cb
int main() {
    // ❌ ラムダ式未実装
    auto add = [](int a, int b) -> int {
        return a + b;
    };
    
    int result = add(3, 5);  // ❌ 未実装
    
    return 0;
}
```

**実装難易度**: 🔴 高

---

### 6.2 デフォルト引数 ❌

**状態**: 完全未実装

**説明**: 
C++のデフォルト引数がありません。

**エラーになるコード**:
```cb
int greet(string name = "World") {  // ❌ デフォルト引数未実装
    println("Hello, ", name);
    return 0;
}
```

**実装難易度**: 🟡 中

---

### 6.3 可変長引数 ❌

**状態**: 完全未実装

**説明**: 
C言語の`...`（可変長引数）がありません。

**エラーになるコード**:
```cb
void print_all(string format, ...) {  // ❌ 可変長引数未実装
    // ...
}
```

**実装難易度**: 🟡 中

---

### 6.4 関数オーバーロード ❌

**状態**: 完全未実装

**説明**: 
同名の関数を異なる引数で定義できません。

**エラーになるコード**:
```cb
int add(int a, int b) {         // ✅ これは動作
    return a + b;
}

double add(double a, double b) { // ❌ オーバーロード未実装
    return a + b;
}
```

**実装難易度**: 🟡 中

---

### 6.5 implメソッドの戻り値アロー演算子 ⚠️

**状態**: 部分未実装

**説明**: 
implメソッドの戻り値に対してアロー演算子が動作しない場合があります。

**問題のあるコード**:
```cb
struct Container {
    Data* data;
}

impl Container {
    Data* get_data() {
        return self.data;
    }
}

int main() {
    Container c;
    int value = c.get_data()->value;  // ⚠️ 動作不安定
    return 0;
}
```

**実装難易度**: 🟡 中

---

## 🔴 7. モジュールシステム ❌

### 7.1 import/export ❌

**状態**: 基本的なincludeは動作するが、モジュールシステムは未実装

**説明**: 
TypeScript/ESModules風の`import`/`export`がありません。

**エラーになるコード**:
```cb
// math.cb
export int add(int a, int b) {  // ❌ export未実装
    return a + b;
}

// main.cb
import { add } from "./math.cb";  // ❌ import未実装

int main() {
    int result = add(3, 5);
    return 0;
}
```

**現在の回避策**:
```cb
// 基本的なincludeは動作（制限あり）
// main.cbからmath.cbを読み込む
```

**実装難易度**: 🔴 高

---

### 7.2 パッケージマネージャ ❌

**状態**: 完全未実装

**説明**: 
npm、cargo、go mod相当のパッケージ管理システムがありません。

**実装難易度**: 🔴 高

---

### 7.3 名前空間/モジュール ❌

**状態**: 完全未実装

**説明**: 
C++の`namespace`、Rustの`mod`相当の機能がありません。

**エラーになるコード**:
```cb
namespace Math {           // ❌ namespace未実装
    int add(int a, int b) {
        return a + b;
    }
}

int main() {
    int result = Math::add(3, 5);  // ❌ 未実装
    return 0;
}
```

**実装難易度**: 🔴 高

---

## 🔴 8. 並行処理 ❌

### 8.1 スレッド ❌

**状態**: 完全未実装

**説明**: 
マルチスレッド機能がありません。

**実装難易度**: 🔴 高

---

### 8.2 非同期処理（async/await）❌

**状態**: 完全未実装

**説明**: 
Rust/JavaScript風の非同期処理がありません。

**実装難易度**: 🔴 高

---

### 8.3 goroutine/channel ❌

**状態**: 完全未実装

**説明**: 
Go言語風の並行処理機構がありません。

**実装難易度**: 🔴 高

---

## 🔴 9. 標準ライブラリの制限

### 9.1 文字列操作関数 ⚠️

**状態**: 部分実装

**説明**: 
基本的な文字列操作は可能だが、以下が不足:
- `split()`, `join()`, `replace()`
- 正規表現
- Unicode正規化

**実装難易度**: 🟡 中

---

### 9.2 ファイルI/O ❌

**状態**: 完全未実装

**説明**: 
ファイル読み込み・書き込み機能がありません。

**エラーになるコード**:
```cb
int main() {
    File f = open("test.txt", "r");  // ❌ ファイルI/O未実装
    string content = f.read();       // ❌ 未実装
    f.close();                       // ❌ 未実装
    
    return 0;
}
```

**実装難易度**: 🟡 中

---

### 9.3 ネットワークI/O ❌

**状態**: 完全未実装

**説明**: 
TCP/UDP、HTTP等のネットワーク機能がありません。

**実装難易度**: 🔴 高

---

### 9.4 日付・時刻 ❌

**状態**: 完全未実装

**説明**: 
日付・時刻処理ライブラリがありません。

**実装難易度**: 🟡 中

---

### 9.5 正規表現 ❌

**状態**: 完全未実装

**実装難易度**: 🔴 高

---

### 9.6 JSON/XMLパーサー ❌

**状態**: 完全未実装

**実装難易度**: 🔴 高

---

## 🔴 10. その他の制限

### 10.1 コメント（複数行）⚠️

**状態**: 単一行コメントは動作、複数行コメントは不明

**説明**: 
`/* ... */`スタイルの複数行コメントの対応状況が不明確。

**動作するコード**:
```cb
// 単一行コメント ✅ 動作
int x = 10; // ✅ 動作
```

**確認が必要なコード**:
```cb
/* 複数行コメント
   の動作確認が必要 */
```

**実装難易度**: 🟢 低

---

### 10.2 演算子オーバーロード ❌

**状態**: 完全未実装

**説明**: 
C++の演算子オーバーロードがありません。

**エラーになるコード**:
```cb
struct Point {
    int x;
    int y;
}

impl Point {
    // ❌ 演算子オーバーロード未実装
    Point operator+(Point other) {
        Point result;
        result.x = self.x + other.x;
        result.y = self.y + other.y;
        return result;
    }
}
```

**実装難易度**: 🔴 高

---

### 10.3 マクロ ❌

**状態**: 完全未実装

**説明**: 
C言語の`#define`、Rustのマクロ相当の機能がありません。

**実装難易度**: 🔴 高

---

### 10.4 アトリビュート/アノテーション ❌

**状態**: 完全未実装

**説明**: 
Rust風の`#[...]`、Java風の`@...`相当の機能がありません。

**実装難易度**: 🔴 高

---

### 10.5 コンパイラディレクティブ ❌

**状態**: 完全未実装

**説明**: 
`#ifdef`、`#pragma`等のコンパイラディレクティブがありません。

**実装難易度**: 🟡 中

---

## 📈 実装優先度の提案

### 🔥 最優先（すぐに実装すべき）

1. **switch/case文** - 🟢 低難易度、高頻度使用
2. **ポインタへの複合代入** - 🟢 低難易度、一貫性向上
3. **デフォルト引数** - 🟡 中難易度、利便性向上
4. **複数行コメント** - 🟢 低難易度（確認が必要）

### 🔴 高優先度（近い将来に実装）

5. **動的配列** - 🟡 中難易度、実用性高
6. **ファイルI/O** - 🟡 中難易度、実用性高
7. **ポインタ演算** - 🟡 中難易度、C互換性向上
8. **関数オーバーロード** - 🟡 中難易度、利便性向上
9. **文字列操作関数拡充** - 🟡 中難易度、実用性高

### 🟡 中優先度（将来実装）

10. **型推論（auto）** - 🟡 中難易度、利便性向上
11. **可変長引数** - 🟡 中難易度、柔軟性向上
12. **日付・時刻ライブラリ** - 🟡 中難易度、実用性向上
13. **const correctness完全実装** - 🟡 中難易度、型安全性向上
14. **implメソッド戻り値アロー演算子修正** - 🟡 中難易度

### 🔵 低優先度（長期計画）

15. **動的メモリ確保（new/delete）** - 🔴 高難易度
16. **スマートポインタ** - 🔴 高難易度
17. **ジェネリクス** - 🔴 高難易度
18. **ラムダ式/クロージャ** - 🔴 高難易度
19. **関数ポインタ** - 🔴 高難易度
20. **モジュールシステム** - 🔴 高難易度
21. **パターンマッチング** - 🔴 高難易度
22. **Result型エラー処理** - 🔴 高難易度
23. **演算子オーバーロード** - 🔴 高難易度
24. **マクロ** - 🔴 高難易度
25. **ネットワークI/O** - 🔴 高難易度
26. **正規表現** - 🔴 高難易度
27. **並行処理（スレッド/async/goroutine）** - 🔴 高難易度

---

## 🎯 まとめ

### 実装状況統計

- ✅ **完全実装済み**: 多数の基本機能
- 🚧 **部分実装**: 10機能程度
- ❌ **未実装**: 約50機能

### 重要な注意点

1. **自己再帰構造体はポインタ経由で動作します**（検証済み）
2. **const関数引数は完全に実装されました**（2024年最新）
3. **構造体システムは実用レベルに達しています**
4. **interfaceシステムで構造体継承を代替可能です**

### 次のステップ

このドキュメントに基づいて、実装優先度の高い機能から順次実装することを推奨します。特に🔥最優先項目は実装難易度が低く、開発者体験を大きく向上させます。

---

**最終更新**: const関数引数実装完了後  
**テスト状況**: 2206/2206 tests passing ✅  
**バージョン**: v0.9.0+
