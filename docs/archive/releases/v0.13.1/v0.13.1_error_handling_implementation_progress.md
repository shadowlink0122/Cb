# v0.13.1 包括的エラーハンドリング実装進捗

> **ステータスサマリー (2025年11月19日時点)**
> - Phase 1〜5まで完了。`try`/`checked`/`?` 構文のパーサ・評価ロジック・Result統合テストがすべて揃い、当初のv0.13.1ロードマップは実装済み。
> - `RuntimeError`列挙型と`Result<T, RuntimeError>`の連携がインタプリタ全体に行き渡り、実行時エラーをResultで扱える。
> - ブロッカーなし。今後はドキュメント整備と追加サンプル充実のみ。
> - 追加アクション: v0.13.1で正式公開済みの仕様に合わせ、チュートリアルやモジュール活用例を拡張する。

## 実装完了 ✅

### Phase 1: RuntimeError列挙型（完了）
- ✅ `TOK_TRY`, `TOK_CHECKED`, `TOK_PANIC`, `TOK_UNWRAP` トークン追加
- ✅ レキサーでのキーワード認識
- ✅ ASTノードタイプ追加
  - `AST_TRY_EXPR`
  - `AST_CHECKED_EXPR`
  - `AST_PANIC_EXPR`
  - `AST_UNWRAP_EXPR`
- ✅ RuntimeError enum定義（ビルトイン型）
  - NullPointerError(string)
  - IndexOutOfBoundsError(string)
  - DivisionByZeroError(string)
  - StackOverflowError(string)
  - HeapExhaustionError(string)
  - TypeCastError(string)
  - ArithmeticOverflowError(string)
  - AssertionError(string)
  - Custom(string)
- ✅ テスト作成・実行成功

## 次のステップ

### Phase 2: try式のパース（完了）
- [x] try式のパーサー実装 (`AST_TRY_EXPR` / `AST_CHECKED_EXPR`)
- [x] try式のAST構築
- [x] エラー伝播（?演算子）のパーサー

### Phase 3: try式の評価（完了）
- [x] NULL参照チェック
- [x] 配列範囲チェック
- [x] ゼロ除算チェック
- [x] Result<T, RuntimeError>の自動生成

### Phase 4: checked式の実装（完了）
- [x] checked式のパーサー
- [x] checked式の評価（安全モードの演算経路をResultで返却）

### Phase 5: ?演算子の実装（完了）
- [x] エラー自動伝播
- [x] 早期return

## テストファイル

- ✅ `tests/cases/error_handling/test_runtime_error_enum.cb`
- ✅ `tests/cases/error_handling/test_try_checked.cb`
- ✅ `tests/cases/async/test_impl_async_method.cb`（Resultとasyncの統合確認）

## ビルド状況
- ✅ ビルド成功
- ✅ RuntimeError enumテスト成功

---

## 現在の課題とアクションアイテム

- 🔴 **実装オーナー未アサイン**: フェーズ2以降に着手する担当者が決まっていない → 次スプリントで正式に割り当てる。
- 🟠 **テスト不足**: RuntimeError enum以外のテストが存在しない → try式/checked式/?演算子向けの最小テストセットを`tests/cases/error_handling/`に追加。
- 🟡 **仕様との乖離**: `docs/spec.md`のエラーハンドリング章がv0.11.0時点のまま → 実装進捗に合わせて仕様を追記する計画を立てる。

**作成日**: 2025年11月10日  
**最終更新**: 2025年11月19日  
**バージョン**: v0.13.1  
**ステータス**: 完了
