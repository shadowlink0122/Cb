# v0.9.2 実装方針まとめ

## 📌 エグゼクティブサマリー

v0.9.1で大規模リファクタリング（Phase 5-8）が完了し、コードベースは良好な状態です。  
v0.9.2では**機能追加**と**品質向上**に注力します。

---

## 🎯 3つの重点領域

### 1. コード最適化・リファクタリング
- interpreter.cpp（1,941行）をさらに分割（目標: 1,000行以下）
- TypeHelpersの拡充（型システムの一貫性向上）
- メモリ管理の最適化（実行速度5-10%向上目標）

### 2. 未実装機能の追加
**優先度: 高**
- ✅ ~~多重ポインタ~~（v0.9.1で既に実装済み）
- ✅ ~~多次元配列ポインタ~~（v0.9.1で実装済み）
- 🔜 **配列参照型**（`int[N]&`）← **最優先**

**優先度: 中**
- 構造体配列メンバーの関数戻り値代入
- 多次元配列の関数戻り値からメンバー代入

**優先度: 低（v0.10.0に延期検討）**
- 動的メモリ管理（new/delete）
- キャスト演算子

### 3. コード品質向上
**優先度: 高**
- エラーメッセージの改善（列番号表示、修正候補提案）
- テストカバレッジ向上（80%目標）
- ドキュメントの充実（チュートリアル作成）

**優先度: 中**
- 警告システムの追加（-Wall, -Werror）
- デバッグ機能の強化（変数ウォッチ、スタックトレース）

---

## 📋 実装ロードマップ

### Phase 1: 基盤整備（1-2週間）
```
✓ interpreter.cppの分割
✓ TypeHelpersの拡充
✓ エラーメッセージの改善
✓ テストカバレッジ向上
```

### Phase 2: 新機能実装（2-3週間）
```
□ 配列参照型（int[N]&）← 最優先
□ 構造体配列メンバーの関数戻り値代入
□ 多次元配列の関数戻り値からメンバー代入
```

### Phase 3: 品質向上（1-2週間）
```
□ 警告システムの追加
□ メモリ管理の最適化
□ パーサーの最適化
□ ドキュメントの充実
```

### Phase 4: 高度な機能（v0.10.0延期検討）
```
□ 動的メモリ管理（new/delete）
□ キャスト演算子
□ デバッグ機能強化
```

---

## ✅ 成功指標

### 必須条件
- [ ] 全テスト合格
- [ ] interpreter.cpp 1,000行以下
- [ ] 配列参照型の実装完了
- [ ] エラーメッセージの改善完了

### 推奨条件
- [ ] 実行速度5-10%向上
- [ ] コードカバレッジ80%以上
- [ ] 警告システム実装
- [ ] ドキュメント更新完了

---

## 🚀 Next Steps

### 今すぐ始めること
1. **interpreter.cppの分割**
   - 1,941行 → 1,000行以下に削減
   - initialization.cpp, cleanup.cpp, utility.cpp に分割

2. **配列参照型の設計**
   - パーサー拡張の検討
   - 型システムへの統合方針決定
   - テストケース設計

3. **エラーメッセージ改善**
   - 列番号表示の実装
   - エラー箇所のコード抜粋表示
   - 修正候補の提案機能

### 検討事項
- 動的メモリ管理をv0.10.0に延期するか？
  - → 実装工数が大きいため、v0.10.0推奨
- デバッグ機能をどこまで実装するか？
  - → 基本的な変数ウォッチのみv0.9.2で実装

---

## 📚 参考ドキュメント

- **詳細計画**: `v0.9.2_implementation_plan.md`
- **旧計画（アーカイブ）**: `v0.9.2_plan.md`
- **v0.9.1実装内容**: `../release_notes/v0.9.1.md`
- **言語仕様書**: `../spec.md`
- **アーキテクチャ**: `../architecture.md`

---

**作成日**: 2025年10月9日  
**バージョン**: v0.9.2  
**ステータス**: 計画策定完了  
**次のアクション**: Phase 1の実装開始
