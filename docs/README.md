# Cb言語ドキュメント

このフォルダには、Cb言語の公式ドキュメントが格納されています。

---

## 📚 主要ドキュメント

### `spec.md` ⭐ **言語仕様書**
Cb言語の完全な言語仕様書です。

**内容**:
- プリミティブ型（tiny, short, int, long, float, double, char, string, bool）
- 配列（静的配列、多次元配列）
- 構造体（ネスト### 2. **アーキテクチャを理解**
   - `architecture.md` を読む
   - インタープリターの内部構造を把握

3. **v0.10.0開発を開始**
   - `todo/v0.10.0_advanced_pointer_features.md` を確認
   - 実装計画に従って開発

4. **ドキュメント更新**
   - 新機能実装時は `spec.md` と `architecture.md` を更新
   - 実装完了時は `archive/` に完了報告書を作成vate メンバー）
- ポインタ（基本ポインタ、関数ポインタ、構造体ポインタ）
- 参照型（`int&`, `Struct&`）
- Interface/Implシステム
- Union型
- enum型
- typedef
- 制御構造（if, for, while, etc.）
- 演算子（算術、論理、ビット、比較、三項、etc.）
- モジュールシステム

**対象読者**: Cb言語の全機能を理解したい開発者

---

### `BNF.md` ⭐ **BNF文法定義**
Cb言語の完全なBNF（Backus-Naur Form）文法定義です。

**内容**:
- プログラム構造
- 変数宣言
- 型システム
- 関数宣言
- Interface/Impl定義
- 制御構造
- 式と演算子
- リテラル

**対象読者**: パーサー実装者、言語の文法を正確に理解したい開発者

---

### `architecture.md` ⭐ **アーキテクチャ設計**
Cbインタープリターの内部設計とアーキテクチャドキュメントです。

**内容**:
- 全体構造（フロントエンド/バックエンド）
- レイヤー構造（Core, Evaluator, Executor, Handler, Manager, Service）
- モジュール分割戦略
- ビルドシステム
- テスト構造

**対象読者**: インタープリター開発者、内部実装を理解したい開発者

---

## 📁 サブフォルダ

### `archive/` - アーカイブドキュメント
過去のドキュメントや、統合・更新されたドキュメントが格納されています。

**内容**:
- 古い実装計画
- 過去のバージョンのドキュメント
- 統合された設計ドキュメント

**参照時**: 過去の設計判断の経緯を確認したい場合

---

### `todo/` - 実装計画・設計ドキュメント
今後の実装計画、設計ドキュメント、実装状況報告書などが格納されています。

**主要ドキュメント**:
- `v0.10.0_advanced_pointer_features.md` - v0.10.0実装計画（最新）
- `v0.9.0_final_implementation_report_complete.md` - v0.9.0実装完了レポート
- `implementation_roadmap.md` - 実装ロードマップ
- `README.md` - todoフォルダの詳細説明

**参照時**: 
- v0.10.0の開発を開始する
- 過去の実装を振り返る
- 実装計画を確認する

詳細は `todo/README.md` を参照してください。

---

## 🔄 ドキュメントの読み方

### 1. Cb言語を学ぶ
→ `spec.md` を読む

### 2. 文法を正確に理解する
→ `BNF.md` を読む

### 3. 今後の実装を確認する
→ `todo/v0.10.0_advanced_pointer_features.md` を読む

### 4. 過去の実装を振り返る
→ `todo/v0.9.0_final_implementation_report_complete.md` を読む

### 5. 古いドキュメントを探す
→ `archive/` フォルダを確認

---

## 📊 ドキュメント構成

```
docs/
├── README.md                          # このファイル（ドキュメント索引）
├── spec.md                            # 言語仕様書（最重要）
├── BNF.md                             # BNF文法定義
├── architecture.md                    # アーキテクチャ設計
├── archive/                           # アーカイブドキュメント
│   ├── phase7_refactoring_complete_report.md  # Phase 7完了報告
│   ├── interpreter_refactoring_*.md   # リファクタリング記録
│   ├── phase*.md                      # 各フェーズ実装記録
│   └── (その他の完了レポート)
└── todo/                              # 実装計画・設計ドキュメント
    ├── README.md                      # todoフォルダの詳細説明
    ├── v0.10.0_advanced_pointer_features.md  # v0.10.0実装計画（最新）
    ├── v0.9.0_*.md                    # v0.9.0関連ドキュメント
    ├── implementation_*.md            # 実装方針・ロードマップ
    └── (その他の設計ドキュメント)
```

---

## ✅ v0.9.0で実装完了した機能

### ポインタシステム
- ✅ 基本ポインタ（`&`, `*`）
- ✅ ポインタ演算（`++`, `--`, `+`, `-`）
- ✅ 構造体ポインタ
- ✅ アロー演算子（`->`）
- ✅ Interfaceポインタ
- ✅ **関数ポインタ**（v0.9.0で完全実装）
- ✅ **ポインタ配列**（`int*[N]`）
- ✅ 16進数アドレス表示

### v0.9.2で追加された機能（2025年10月10日リリース）
- ✅ **配列参照渡し**（Array Reference Parameters）
  - `int[N]&` 形式で配列を参照として関数に渡す
  - 配列のコピーを回避し、効率的な値の受け渡し
- ✅ **構造体メンバの再帰的代入処理**
  - ネストした構造体メンバへの完全な代入サポート
  - 任意の深さのメンバアクセスに対応
- ✅ **ポインタテストスイートの大規模リファクタリング**
  - 1,680行の巨大ファイルを8カテゴリに分割
  - 388個のポインタテストを機能別に整理
- ✅ **配列型推論の改善**
  - 配列リテラルでのfloat判定を改善
- ✅ **文字列null終端とnullキーワード**
  - C言語互換の文字列処理
  - `null`キーワードのサポート

詳細は `../release_notes/v0.9.2.md` を参照してください。

### v0.9.1で追加された機能（2025年10月9日リリース）
- ✅ **Const Pointer Safety**（const安全性機能）
  - `const int*`（ポインタが指す先がconst）
  - `int* const`（ポインタ自体がconst）
  - `const int* const`（両方const）
  - const違反の完全な検出と防止
- ✅ **多次元配列ポインタ**
  - `&matrix[i][j]`形式のポインタ取得
  - 多次元配列要素のアドレス操作
- ✅ **Phase 5-8リファクタリング完了**
  - ディレクトリ構造の再編成（evaluator, executors, handlers, managers）
  - DRY原則の徹底適用（TypeHelpers導入）

詳細は `spec.md`の「Const Pointer Safety」セクションおよび `../release_notes/v0.9.1.md` を参照してください。

### 参照型システム
- ✅ **基本参照型**（`int&`）
- ✅ **構造体参照型**（`Struct&`）

### その他
- ✅ unsigned修飾子
- ✅ float/double型
- ✅ enum型
- ✅ typedef
- ✅ ネスト構造体
- ✅ Interface/Implシステム
- ✅ impl内static変数
- ✅ Union型

詳細は `../release_notes/v0.9.0.md` を参照してください。

---

## 🚀 v0.10.0で実装予定の機能

### 🔴 最優先: const * const型安全性の完全実装

**現状の問題**: v0.9.2の`const * const`は**ローカル変数でのみ**Rust Pin相当の不変性を保証し、関数パラメータと戻り値で型情報が失われます。

**v0.10.0での対応**:
1. 関数パラメータでの型チェック実装（`const T* const` → `T*`禁止）
2. 関数戻り値での型チェック実装
3. 完全なRust Pin<&T>相当の保証

詳細: `todo/const_pointer_type_safety_plan.md`

### その他の実装予定機能

#### 完了済み機能の整理
- ~~constポインタ（完全実装）~~ ✅ v0.9.1で実装完了（ローカル変数のみ）
- ~~多次元配列へのポインタ~~ ✅ v0.9.1で実装完了
- ~~配列参照型（`int[N]&`）~~ ✅ v0.9.2で実装完了
- ~~多重ポインタ（`int**`, `int***`）~~ ✅ v0.9.1で実装済み
- ~~ポインタ演算の拡張（`ptr + n`, `ptr - n`）~~ ✅ v0.9.0で実装済み（バグあり）

#### v0.10.0で新規実装
1. **ポインタ演算のバグ修正**（境界チェック改善）
2. **動的メモリ管理**（`new`/`delete`演算子）
3. **キャスト演算子**（`static_cast<T>()`）

詳細は `todo/v0.9.2_implementation_status_detailed.md` および `todo/const_pointer_type_safety_plan.md` を参照してください。

---

## 📝 ドキュメント管理ルール

### 1. 主要ドキュメント（docsフォルダ直下）
- 言語仕様書（`spec.md`）
- BNF文法定義（`BNF.md`）
- READMEファイル

**更新頻度**: 機能実装時に更新

### 2. 実装計画・設計（todoフォルダ）
- 今後の実装計画
- 設計ドキュメント
- 実装状況報告書

**更新頻度**: 実装計画策定時、実装完了時

### 3. アーカイブ（archiveフォルダ）
- 古いドキュメント
- 統合・更新されたドキュメント

**更新頻度**: ドキュメント整理時

---

## 🎯 次のアクション

### 開発者向け

1. **新機能を学ぶ**
   - `spec.md` を読む
   - サンプルコード（`../sample/`）を実行

2. **v0.10.0開発を開始**
   - `todo/v0.10.0_advanced_pointer_features.md` を確認
   - 実装計画に従って開発

3. **ドキュメント更新**
   - 新機能実装時は `spec.md` を更新
   - 実装完了時は `todo/` に状況報告書を作成

### ドキュメント管理者向け

1. **定期的な整理**
   - 古いドキュメントを `archive/` に移動
   - 統合可能なドキュメントを統合

2. **リリース時の更新**
   - `spec.md` の更新確認
   - リリースノート作成
   - 実装状況報告書の作成

---

## 📞 お問い合わせ

バグ報告や機能リクエストは、GitHubのIssueでお願いします。

---

**最終更新**: 2025年10月10日  
**Cb言語バージョン**: v0.9.2 (Array Reference & Test Refactoring)  
**管理者**: Cb開発チーム
