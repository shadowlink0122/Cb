// Phase 2.0 Test: Loop fairness in cooperative multitasking
// Tasks with loops should not monopolize execution
// Expected: Loop iterations should interleave with other tasks

async Future<int> heavy_task() {
    println("Heavy: Start");
    for (int i = 0; i < 10; i++) {
        println("Heavy: Loop iteration {i}");
    }
    println("Heavy: Done");
    return 100;
}

async Future<int> light_task() {
    println("Light: Start");
    for (int i = 0; i < 10; i++) {
        println("Light: Loop iteration {i}");
    }
    println("Light: Done");
    return 200;
}

void main() {
    println("=== Loop Fairness Test ===");
    
    // 両方のタスクを登録
    Future<int> f1 = heavy_task();
    Future<int> f2 = light_task();
    
    println("Tasks registered, awaiting...");
    
    // 両方のタスクを待機
    int r1 = await f1;
    int r2 = await f2;
    
    println("Results: {r1}, {r2}");
}
