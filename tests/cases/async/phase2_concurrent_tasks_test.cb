// Phase 2.0 Test: Concurrent task execution
// async関数を呼び出すとタスクが登録され、awaitで結果を待機する
// 複数のタスクを登録してから一斉にawaitすることで並行実行を確認

async int task1() {
    println("Task1: Start");
    println("Task1: Step 1");
    println("Task1: Step 2");
    println("Task1: Done");
    return 100;
}

async int task2() {
    println("Task2: Start");
    println("Task2: Step 1");
    println("Task2: Done");
    return 200;
}

async int task3() {
    println("Task3: Start");
    println("Task3: Processing");
    println("Task3: Done");
    return 300;
}

void main() {
    println("=== Concurrent Tasks Test ===");
    
    // タスクを登録（すぐに実行開始されるが、awaitはまだしない）
    println("Registering tasks...");
    Future<int> f1 = task1();
    Future<int> f2 = task2();
    Future<int> f3 = task3();
    println("All tasks registered");
    
    // ここまでで、3つのタスクが協調的マルチタスクで実行される
    // awaitで結果を取得
    println("Awaiting results...");
    int r1 = await f1;
    println("Got r1: {r1}");
    
    int r2 = await f2;
    println("Got r2: {r2}");
    
    int r3 = await f3;
    println("Got r3: {r3}");
    
    println("=== Test Complete ===");
    println("Results: {r1}, {r2}, {r3}");
}
