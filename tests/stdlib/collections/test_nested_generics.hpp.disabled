#pragma once

#include "../framework/stdlib_test_framework.hpp"

inline void test_nested_generics_execution() {
    // tests/cases/stdlib/collections/test_nested_generics.cb を実行
    // run_cb_test関数内で `cd ../..` されるため、ルートからのパスを指定
    auto [output, exit_code] = run_cb_test(
        "tests/cases/stdlib/collections/test_nested_generics.cb");
    
    // exit codeの検証（正常終了を期待）
    STDLIB_ASSERT_EQ(0, exit_code);
    
    // 出力内容の検証
    STDLIB_ASSERT_CONTAINS(output, "=== Test 1: Vector<Queue<long>> Creation and Push ===");
    STDLIB_ASSERT_CONTAINS(output, "=== Test 2: Vector<Queue<long>> Get and Verify ===");
    STDLIB_ASSERT_CONTAINS(output, "=== Test 3: Vector<Queue<int>> Multiple Queues ===");
    STDLIB_ASSERT_CONTAINS(output, "=== Test 4: Queue<Vector<long>> Creation and Enqueue ===");
    STDLIB_ASSERT_CONTAINS(output, "=== Test 5: Queue<Vector<long>> Dequeue and Verify ===");
    STDLIB_ASSERT_CONTAINS(output, "=== Test 6: Queue<Vector<int>> Multiple Vectors ===");
    STDLIB_ASSERT_CONTAINS(output, "=== Test 7: Empty Nested Containers ===");
    STDLIB_ASSERT_CONTAINS(output, "✅ All nested generic tests passed!");
}

inline void register_nested_generics_tests(StdlibTestRunner& runner) {
    runner.add_test("nested_generics_execution", test_nested_generics_execution);
}
