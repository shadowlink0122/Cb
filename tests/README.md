# Cb テストガイド

## テスト構造

Cbプロジェクトのテストは、**統合テスト (Integration Tests)** と **ユニットテスト (Unit Tests)** の2つに分かれています。

### 統合テスト (tests/integration/)

**目的**: Cb言語の機能をエンドツーエンドでテストします。

- **対象**: Cbプログラムの実行結果や動作
- **スコープ**: 言語機能全体（構文、セマンティクス、実行結果）
- **実行方法**: 
  - インタプリタモード: Cbプログラムを実行し、出力を検証
  - コンパイラモード: Cbプログラムをコンパイルし、成功を検証

**例**:
- 算術演算が正しく動作するか
- if文、for文などの制御構文が正しく動作するか
- 構造体、配列、ポインタなどのデータ構造が正しく動作するか
- FFI（外部関数インターフェース）が正しく動作するか

**注意**: 統合テストでは、HIR/MIR/LIRなどの中間表現の詳細は検証しません。

### ユニットテスト (tests/unit/)

**目的**: 個々のコンポーネントや中間表現を詳細にテストします。

#### HIRテスト (tests/unit/hir/)
- **対象**: HIR (High-level Intermediate Representation) の生成と変換
- **スコープ**: ASTからHIRへの変換ロジック
- **実行方法**: `make -f Makefile.hir test-hir`

#### MIRテスト (tests/unit/mir/)
- **対象**: MIR (Mid-level Intermediate Representation) の生成と最適化
- **スコープ**: HIRからMIRへの変換ロジック

#### LIRテスト (tests/unit/lir/)
- **対象**: LIR (Low-level Intermediate Representation) の生成とコード生成
- **スコープ**: MIRからLIR、そして最終的な機械語への変換ロジック

#### その他のユニットテスト
- **backend/**: バックエンド固有の機能テスト
- **common/**: 共通ユーティリティのテスト
- **framework/**: テストフレームワーク自体のテスト

## テスト実行方法

### 統合テストの実行
```bash
cd tests/integration
make test
```

### ユニットテストの実行
```bash
cd tests/unit

# HIRテスト
make -f Makefile.hir test-hir

# その他のユニットテスト
make test
```

## テスト作成ガイドライン

### 統合テストを作成する場合
1. Cb言語の機能をテストしたい場合
2. エンドツーエンドの動作を確認したい場合
3. ユーザー視点での動作を検証したい場合

### ユニットテストを作成する場合
1. HIR/MIR/LIRの生成ロジックをテストしたい場合
2. 特定のコンポーネントの詳細な動作を検証したい場合
3. 最適化パスや変換ロジックをテストしたい場合

## まとめ

- **統合テスト**: Cb言語の機能テスト（言語ユーザー視点）
- **ユニットテスト**: HIR/MIR/LIRなどの内部実装テスト（開発者視点）

この分離により、テストの責務が明確になり、保守性が向上します。
