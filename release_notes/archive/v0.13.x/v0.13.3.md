# Cb言語 v0.13.3 リリースノート

**リリース日**: 2025年11月16日  
**ステータス**: ✅ Released

---

## 🎯 ハイライト

- **ドキュメント整備** — 既知の問題と制限事項の明確化
- **テストスイートの拡張** — v0.13.3専用のテストケースを追加
- **安定性の向上** — 既存機能の回帰テストを強化

---

## 📋 主な変更点

### ドキュメント

- v0.13.3用のテストディレクトリとテストケースを追加
- 既知の問題と回避策を明確に文書化
- 将来のバージョンで実装予定の機能リストを更新

### テスト

新規テストケースを追加（将来の実装準備）:
- `test_empty_string.cb` - 空文字列表示のテスト
- `test_vector_string.cb` - Vector<string>のテスト（スキップ）
- `test_generic_arrays.cb` - ジェネリック配列のテスト
- `test_nested_match.cb` - ネストしたmatchのテスト

### 安定性

- 既存の全テスト（33テスト、5スイート）が引き続きパス
- 後方互換性を維持

---

## ⚠️ 既知の問題と制限事項

### 1. 文字列配列の初期化

**問題**:
```cb
string[3] arr;  // 宣言は成功
arr[0] = "Hello";  // セグメンテーションフォールト
```

**状態**: 調査中  
**回避策**: 文字列配列リテラルを使用する
```cb
string[3] arr = ["Hello", "World", "!"];  // リテラルからの初期化は動作
```

**計画**: v0.13.4での修正を予定

### 2. Vector<string>のサポート

**問題**:
```cb
Vector<string> vec;
vec.push_back("Hello");  // セグメンテーションフォールト
```

**状態**: 未サポート  
**根本原因**: 文字列のdeep copyメカニズムが未実装  
**回避策**: `Vector<int>`や`Vector<struct>`を使用

**計画**: v0.13.4または v0.14.0での実装を予定

### 3. ジェネリック構造体配列

**問題**:
```cb
Future<int>[3] futures;
futures[0] = compute(10);
int r = await futures[0];  // 型情報が失われる可能性
```

**状態**: 部分的にサポート  
**制限**: 配列要素アクセス時に型情報が不完全な場合がある  
**回避策**: 個別の変数を使用

```cb
Future<int> f1 = compute(10);
Future<int> f2 = compute(20);
int r1 = await f1;  // 動作する
int r2 = await f2;
```

**計画**: v0.13.4での完全サポートを予定

### 4. ネストしたmatch式

**問題**:
```cb
Option<Result<int, string> > outer = ...;
match (outer) {
    Some(inner) => {
        match (inner) {  // 型情報が失われる
            Ok(v) => { /* ... */ }
            Err(e) => { /* ... */ }
        }
    }
    None => { /* ... */ }
}
```

**状態**: 調査中  
**制限**: 2段階以上のmatchで内側の型情報が失われることがある  
**回避策**: matchを分割し、中間変数に代入

```cb
match (outer) {
    Some(inner_result) => {
        Result<int, string> result = inner_result;
        match (result) {  // 新しいmatch文
            Ok(v) => { /* ... */ }
            Err(e) => { /* ... */ }
        }
    }
    None => { /* ... */ }
}
```

**計画**: v0.13.4での修正を予定

---

## ✅ 動作が確認されている機能

### Async/Await（v0.12.0~v0.13.1）
- ✅ 基本的なasync関数とawait
- ✅ async Result<T, E>
- ✅ asyncラムダ式
- ✅ impl内のasyncメソッド
- ✅ selfの自動同期

### ジェネリクス（v0.11.0~v0.13.2）
- ✅ ジェネリック構造体
- ✅ Result<T, E>、Option<T>、Future<T>
- ✅ ジェネリックインターフェースとimpl
- ✅ ネストしたジェネリック型（スペース必須: `Option<Result<int, string> >`）
- ✅ Generic構造体の配列メンバー（`Container<string>`など）

### パターンマッチング（v0.11.0~）
- ✅ 1段階のmatch式
- ✅ Result<T, E>とOption<T>のmatch
- ✅ 値の抽出

---

## 📊 テスト統計

### テスト実行結果
- **総テスト数**: 33テスト
- **成功率**: 100%
- **テストスイート**: 5スイート、全てパス

### テストカバレッジ
- Integration tests: ✅
- Unit tests: ✅  
- Stdlib C++ tests: ✅
- Stdlib Cb tests: ✅

---

## 📚 ドキュメント

### 更新されたドキュメント
- `IMPLEMENTATION_STATUS.md` - 実装状況の更新
- `docs/todo/v0.13.3/README.md` - v0.13.3実装計画
- `tests/cases/v0.13.3/` - 新規テストケース

### 参考ドキュメント
- `release_notes/v0.13.2.md` - v0.13.2リリースノート
- `release_notes/v0.13.1.md` - v0.13.1リリースノート
- `docs/features/v0.13.0_untested_behaviors.md` - 未実装・未確認機能

---

## 🔄 アップグレード手順

v0.13.2からv0.13.3へのアップグレードは完全に後方互換性があります：

1. 最新のソースコードを取得
2. `make clean && make` でビルド
3. `make test` でテスト実行

既存のコードに変更は不要です。

---

## 🚀 次のステップ（v0.13.4計画）

### 優先度: 高
- [ ] 文字列配列の初期化問題の修正
- [ ] Vector<string>のサポート（deep copy実装）
- [ ] ジェネリック構造体配列の完全サポート
- [ ] ネストしたmatch式の型情報保持

### 優先度: 中
- [ ] パフォーマンス最適化
- [ ] エラーメッセージの改善
- [ ] デバッグ機能の強化

### 優先度: 低
- [ ] 追加のビルトイン型
- [ ] 標準ライブラリの拡張

---

## 🎯 開発方針

v0.13.3はドキュメント整備と既知の問題の明確化に焦点を当てたリリースです。これにより、ユーザーは現在の制限事項を理解し、適切な回避策を使用できます。

v0.13.4では、これらの既知の問題に対する修正を実装する予定です。

---

## 謝辞

Cb言語の開発にご協力いただいている全ての方々に感謝します。問題報告、フィードバック、コントリビューションをお待ちしています。

---

**リリース担当**: Cb Language Team  
**最終更新**: 2025年11月16日
